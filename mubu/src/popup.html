<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=400, height=600, user-scalable=no">
  <title>幕布导出工具</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  
  <div class="container" tabindex="-1" autofocus>
  <!-- 登录按钮 -->
  <button id="login-btn" class="top-right-btn login-btn" title="前往幕布登录页">
    <img src="../asserts/login.svg" alt="登录" class="login-icon">
  </button>

  <!-- 赞助按钮 -->
  <button id="sponsor-btn" class="top-right-btn sponsor-btn" title="赞助支持">
    <img src="../asserts/sponsors.png" alt="赞助" class="sponsor-icon">
  </button>

  
  <!-- 设置按钮 -->
  <button id="settings-btn" class="top-right-btn settings-btn" title="打开设置">
    <img src="../asserts/setting.svg" alt="设置" class="settings-icon">
  </button>

  <!-- 重置按钮 -->
  <button id="reset-btn" class="top-right-btn settings-btn" title="退出">
    <img src="../asserts/exit.svg" alt="退出" class="settings-icon">
  </button>
  
    <div class="header">
      <div class="header-content">
        <img src="../icons/icon48.png" alt="幕布导出工具" class="header-icon">
        <h2>幕布导出工具</h2>
      </div>
    </div>
    
    <div class="form-group select-group">
      <label for="exportType">📄 导出格式:</label>
      <div class="select-container has-icon has-selection">
        <img
          id="exportTypeIcon"
          class="select-icon is-visible"
          src="../asserts/markdown.png"
          alt="导出格式图标"
        />
        <select id="exportType">
          <option value="md" data-icon="../asserts/markdown.png">Markdown (.md)</option>
          <option value="opml" data-icon="../asserts/opml.png">OPML (.opml)</option>
          <option value="mm" data-icon="../asserts/xmind.png">Freemind (.mm)</option>
          <option value="html" data-icon="../asserts/html.png">HTML (.html)</option>
          <option value="json" data-icon="../asserts/json.png">原始结构 (.json)</option>
        </select>
        <button
          type="button"
          id="exportTypeTrigger"
          class="select-trigger"
          aria-haspopup="listbox"
          aria-controls="exportTypeOptions"
          aria-expanded="false"
          hidden
        >
          <span id="exportTypeLabel" class="select-trigger-text">Markdown (.md)</span>
        </button>
        <ul id="exportTypeOptions" class="select-options" role="listbox" hidden></ul>
      </div>
    </div>

    <div id="fileInfo" class="file-info">
      <p>
        <strong>📄 文档总数:</strong> 
        <span id="totalFiles">0</span>
        <span>    </span>
        <strong>🗂️ 文件夹数:</strong>
        <span id="folderCount">0</span>
      </p>
    </div>
    
    <div class="form-group">
      <button id="getInfo" type="button" class="btn btn-primary">
        <span>🔍 获取文件信息</span>
      </button>
    </div>
    
    <div class="form-group action-buttons">
      <button id="startExport" type="button" class="btn btn-start">
        <span>🚀 开始导出</span>
      </button>
      <button id="pauseExport" type="button" class="btn btn-pause" style="display: none;">
        <span>⏸️ 暂停导出</span>
      </button>
    </div>

    <div id="retrySection" style="display:none;" class="form-group">
      <button id="retryFailedBtn" type="button" class="btn btn-retry">
        <span>🔄 重试失败的文件</span>
      </button>
      <div id="failedList"></div>
    </div>
    
    <div class="progress-bar" id="progressBar" style="display: none;">
      <div class="progress-fill" id="progressFill"></div>
      <div class="progress-text" id="progressText"></div>
    </div>
    
    <div id="status" class="status" style="display: none;"></div>
    
    <div class="log-container" id="logContainer">
      <div class="log-placeholder">
        <p>👏👏👏</p>
        <p>欢迎使用幕布导出工具！</p>
        <p class="log-tip">✨ 请先 <img src="../asserts/login.svg" style="width: 16px; height: 16px;background-color: aliceblue;border-radius: 50%;" alt="登录" class="login-icon"> 前往幕布登录</p>
        <p class="log-tip">✨ 点击🔍获取信息后，点击🚀按钮开始导出</p>
        <p class="log-tip">✨ Tips：点击 ⚙️ 可以设置导出目录</p>
        <p class="log-tip">✨ Tips：点击 <img src="../asserts/sponsors.png" style="width: 16px; height: 16px;" alt="赞助" class="sponsor-icon"> 可以赞助支持我</p>
      </div>
    </div>
  </div>
  
  <!-- 赞助模态框 -->
  <div id="sponsorModal" class="sponsor-modal" aria-hidden="true">
    <div class="sponsor-modal-card" role="dialog" aria-modal="true" aria-labelledby="sponsorTitle">
      <button id="sponsorModalClose" class="sponsor-modal-close" aria-label="关闭赞助二维码">&times;</button>
      <div class="sponsor-modal-header">
        <h3 id="sponsorTitle">请我喝杯咖啡 ☕️</h3>
        <p>如果这个工具帮到了你，欢迎小额赞助支持我继续维护。</p>
      </div>
      <div class="sponsor-modal-body">
        <img src="../asserts/sp.jpeg" alt="赞助二维码" class="sponsor-qr">
        <p class="sponsor-tip">长按或扫描二维码，金额随意，感谢支持！</p>
      </div>
    </div>
  </div>
  
  <script type="module" src="popup.js"></script>
</body>
</html> 